import { ActionOptions, IntegrityItem, IntegrityItemType, MOVED_POSITION } from '@data';
import { ACTION_TYPE, ParentItemHandler } from '../../../src/service/parent-item-handler';

const items: IntegrityItem[] = [{
    'id': '7337',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7336',
    'category': 'Heading',
    'primarySection': '1',
    'secondarySection': '1',
    'text': '1',
    'type': IntegrityItemType.NONE,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '1',
}, {
    'id': '7344',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7337',
    'category': 'Heading',
    'primarySection': '1.1',
    'secondarySection': '1.1',
    'text': '1.1',
    'type': IntegrityItemType.NONE,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '1.1',
}, {
    'id': '7338',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7336',
    'category': 'Heading',
    'primarySection': '2',
    'secondarySection': null,
    'text': '2',
    'type': IntegrityItemType.NONE,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '2',
}, {
    'id': '7347',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7338',
    'category': 'Comment',
    'primarySection': '2.1',
    'secondarySection': null,
    'text': '2.1',
    'type': IntegrityItemType.DELETE,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '2.1',
}, {
    'id': '7339',
    'oldId': null,
    'secondaryId': '7398',
    'parentId': '7336',
    'category': 'Heading',
    'primarySection': '3',
    'secondarySection': '5',
    'text': '3',
    'type': IntegrityItemType.MOVED,
    'changedFields': {},
    'movedPosition': MOVED_POSITION.OLD,
    'changedAttachments': [],
    'section': '3',
}, {
    'id': '7349',
    'oldId': null,
    'secondaryId': '7405',
    'parentId': '7339',
    'category': 'Comment',
    'primarySection': '3.1',
    'secondarySection': '5.1',
    'text': '3.1',
    'type': IntegrityItemType.MOVED,
    'changedFields': {},
    'movedPosition': MOVED_POSITION.OLD,
    'changedAttachments': [],
    'section': '3.1',
}, {
    'id': '7340',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7336',
    'category': 'Heading',
    'primarySection': '4',
    'secondarySection': '2',
    'text': '3',
    'type': IntegrityItemType.NONE,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '3',
}, {
    'id': '7351',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7340',
    'category': 'Comment',
    'primarySection': '4.1',
    'secondarySection': '2.1',
    'text': '3.1',
    'type': IntegrityItemType.NONE,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '3.1',
}, {
    'id': '7341',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7336',
    'category': 'Heading',
    'primarySection': '5',
    'secondarySection': '3',
    'text': '4',
    'type': IntegrityItemType.NONE,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '4',
}, {
    'id': '7356',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7341',
    'category': 'Comment',
    'primarySection': '5.1',
    'secondarySection': '3.1',
    'text': '4.1',
    'type': IntegrityItemType.NONE,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '4.1',
}, {
    'id': '7408',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7393',
    'category': 'Functional Requirement',
    'primarySection': null,
    'secondarySection': '4',
    'text': '5',
    'type': IntegrityItemType.NEW,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '5',
}, {
    'id': '7410',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7408',
    'category': 'Functional Requirement',
    'primarySection': null,
    'secondarySection': '4.1',
    'text': '5.1',
    'type': IntegrityItemType.NEW,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '5.1',
}, {
    'id': '7339',
    'oldId': null,
    'secondaryId': '7398',
    'parentId': '7336',
    'category': 'Heading',
    'primarySection': '3',
    'secondarySection': '5',
    'text': '6',
    'type': IntegrityItemType.MOVED,
    'changedFields': {},
    'movedPosition': MOVED_POSITION.NEW,
    'changedAttachments': [],
    'section': '6',
}, {
    'id': '7349',
    'oldId': null,
    'secondaryId': '7405',
    'parentId': '7339',
    'category': 'Comment',
    'primarySection': '3.1',
    'secondarySection': '5.1',
    'text': '6.1',
    'type': IntegrityItemType.MOVED,
    'changedFields': {},
    'movedPosition': MOVED_POSITION.NEW,
    'changedAttachments': [],
    'section': '6.1',
}, {
    'id': '7342',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7336',
    'category': 'Heading',
    'primarySection': '6',
    'secondarySection': '6',
    'text': '7',
    'type': IntegrityItemType.NONE,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '7',
}, {
    'id': '7361',
    'oldId': null,
    'secondaryId': null,
    'parentId': '7342',
    'category': 'Comment',
    'primarySection': '6.1',
    'secondarySection': '6.1',
    'text': '7.1',
    'type': IntegrityItemType.NONE,
    'changedFields': {},
    'movedPosition': null,
    'changedAttachments': [],
    'section': '7.1',
}];
test('decline moved if before accepted deleted and added items.', () => {

    const documentId = '#documentId';

    const expectedResult: ActionOptions[] = [
        {
            item: items[4],
            action: ACTION_TYPE.DECLINE,
            order: 1,
            parentInTheNewPosition: null,
            insertLocation: null,
        },
        {
            item: items[5],
            action: ACTION_TYPE.DECLINE,
            order: 2,
            parentInTheNewPosition: null,
            insertLocation: null,
        },

    ];

    const results = new ParentItemHandler(items, documentId).handleOptions(items[4], ACTION_TYPE.DECLINE);
    expect(results).toStrictEqual(expectedResult);
});
